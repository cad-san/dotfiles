#!/bin/sh

# search histroy with percol
_replace_by_history() {
  local l=$(HISTTIMEFORMAT= history | tac | sed -e 's/^\s*[0-9]\+\s\+//' | percol --query "$READLINE_LINE")
  READLINE_LINE="$l"
  READLINE_POINT=${#l}
}
bind -x '"\C-r": _replace_by_history'
bind    '"\C-xr": reverse-search-history'

# for git
function percol-git-branch()
{
	git branch | percol | sed -e "s/^\*[ ]*//g" | xargs --no-run-if-empty git $*
}

function percol-git-status-files () {
    git status --porcelain | percol | awk '{ print $2 }' | xargs --no-run-if-empty git $*
}

function percol-git-ls-files()
{
	git ls-files | percol
}

alias gpbr='percol-git-branch'
alias gpls='percol-git-ls-files'
alias gpst='percol-git-status-files'
